(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{107:function(e,t,n){"use strict";n.r(t);var s,a=n(2),c=n.n(a),i=n(47),r=n.n(i),l=n(48),o=n(9),u=n(10),h=n(12),m=n(11),d=n(13),j=n.n(d),b=(n(56),n(0)),p=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(o.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={userStatus:"not defined"},e}return Object(u.a)(n,[{key:"componentDidUpdate",value:function(e,t){e.userStatus!==this.props.userStatus&&this.setState({status:"no such user"})}},{key:"render",value:function(){var e=this.props,t=e.pwd,n=e.email,s=e.handleInputChange,a=e.handleSubmit,c=[j.a.form,"joinForm"].join(" "),i=[j.a.label,"joinLabel"].join(" "),r=[j.a.label,"joinInput"].join(" "),l=[j.a.title,"joinTitle"].join(" ");return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("h1",{className:l,children:"Join the online chat as:"}),Object(b.jsxs)("form",{className:c,onSubmit:a,children:[Object(b.jsxs)("label",{className:i,children:["E-mail:"," ",Object(b.jsx)("input",{autoFocus:!0,autoComplete:"off",className:r,placeholder:"Email",name:"email",value:n,type:"text",onChange:s})]}),Object(b.jsxs)("label",{className:i,children:["Password:"," ",Object(b.jsx)("input",{autoComplete:"off",className:r,placeholder:"Password",name:"pwd",value:t,type:"password",onChange:s})]}),n&&t&&Object(b.jsx)("button",{className:j.a.btn,type:"submit",children:"Sign up"})]})]})}}]),n}(a.Component),f=n(22),g=n(49),O=n.n(g),x=n(108),v=function(e){var t=e.onlineUsers,n=e.allUsers,s=e.handleMute,a=e.handleBun;return Object(b.jsxs)("ul",{className:"chatUsersList",children:[t.length>0&&t.map((function(e){var t=e.email;return Object(b.jsx)("li",{className:"chatUserItem",children:Object(b.jsx)("p",{className:"chatUser",children:t})},Object(x.a)())})),n.length>0&&n.map((function(e){var t=e.email,n=e.muted,c=e.banned;return Object(b.jsxs)("li",{className:"chatUserItem",children:[Object(b.jsx)("p",{className:"chatUser",children:t}),Object(b.jsx)("span",{onClick:function(){return s(t)},className:"chatMute",children:n?"Unmute":"Mute"}),Object(b.jsx)("span",{onClick:function(){return a(t)},className:"chatBun",children:c?"Unbanne":"Banne"})]},Object(x.a)())})),Object(b.jsx)("li",{id:"scrollUser"})]})},S=function(e){var t=e.messages,n=e.email;return Object(b.jsxs)("ul",{className:"chatList",children:[t.map((function(e){var t=e.user,s=e.text,a=e.color;return Object(b.jsxs)("li",{style:{backgroundColor:a},className:t===n?"chatMsgItem chatMsgItemInner":"chatMsgItem chatMsgItemOuter",children:[Object(b.jsx)("p",{className:"chatAuthor",children:t}),Object(b.jsx)("p",{className:"chatMsg",children:s})]},Object(x.a)())})),Object(b.jsx)("li",{id:"scrollMessage"})]})},U=function(e){var t=e.handleSubmit,n=e.currentMsg,s=e.handleInput;return Object(b.jsxs)("form",{className:"chatForm",onSubmit:t,children:[Object(b.jsxs)("label",{className:"chatLabel",children:["Type to the chat:",Object(b.jsx)("input",{autoFocus:!0,maxLength:"200",className:"chatInput",type:"text",value:n,onChange:s})]}),Object(b.jsx)("button",{className:"sendBtn",type:"submit",children:"Send"})]})},y=(n(88),function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,c=new Array(a),i=0;i<a;i++)c[i]=arguments[i];return(e=t.call.apply(t,[this].concat(c))).state={email:"",currentMsg:"",messages:[],isAdmin:null,onlineUsers:[],allUsers:[]},e.handleInput=function(t){e.setState({currentMsg:t.target.value})},e.handleSubmit=function(t){t.preventDefault(),e.sendMsg()},e.sendMsg=function(){s.emit("userMsg",e.state.currentMsg,(function(){e.setState({currentMsg:""})}))},e.handleMute=function(e){s.emit("mute",e,(function(){}))},e.handleBun=function(e){s.emit("bun",e,(function(){}))},e.handleExitBtn=function(){e.props.handleChatExit(),s.disconnect()},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({isAdmin:this.props.isAdmin}),(s=O()("https://chat-app-maybe.herokuapp.com/",{transports:["websocket"],auth:{token:localStorage.getItem("token")}})).on("currentUser",(function(t){var n=t.email;e.setState({email:n})})),s.on("connect_error",(function(e){console.log(e.message)})),document.querySelector("#scrollMessage").scrollIntoView({behavior:"smooth"}),s.emit("join",(function(e){e&&alert(e)})),s.on("message",(function(t){e.setState((function(e){return{messages:[].concat(Object(f.a)(e.messages),[t])}}))})),s.on("msgsFromDB",(function(t){e.setState((function(e){return{messages:[].concat(Object(f.a)(e.messages),[t])}}))})),s.on("disconnect",(function(t){console.log(t),"io server disconnect"===t&&alert("Check if you have another opened tab with this email. If no - you was banned by chat administration and can't enter for a while"),s.disconnect(),e.props.handleChatExit()}))}},{key:"componentDidUpdate",value:function(e,t){var n=this;t.messages.length<this.state.messages.length&&document.querySelector("#scrollMessage").scrollIntoView({behavior:"smooth"}),t.onlineUsers.length<this.state.onlineUsers.length&&document.querySelector("#scrollUser").scrollIntoView({behavior:"smooth"}),t.allUsers.length<this.state.allUsers.length&&document.querySelector("#scrollUser").scrollIntoView({behavior:"smooth"}),t.isAdmin!==this.state.isAdmin&&(this.state.isAdmin?s.on("usersForAdmin",(function(e){n.setState({allUsers:e.usersForAdmin})})):s.on("info",(function(e){var t=e.onlineUsers;n.setState({onlineUsers:t})})))}},{key:"componentWillUnmount",value:function(){s.disconnect()}},{key:"render",value:function(){var e=this.state,t=e.onlineUsers,n=e.allUsers,s=e.messages,a=e.email,c=e.currentMsg;return Object(b.jsxs)("div",{className:"box",children:[Object(b.jsx)("h1",{className:"chatTitle",children:"Chat"}),Object(b.jsx)(U,{handleInput:this.handleInput,currentMsg:c,handleSubmit:this.handleSubmit}),Object(b.jsxs)("div",{className:"innerContainer",children:[Object(b.jsx)("div",{className:"messagesBox",children:Object(b.jsx)(S,{email:a,messages:s})}),Object(b.jsxs)("div",{className:"onlineUsersBox",children:[Object(b.jsx)("h2",{className:"chatSubtitle",children:this.state.onlineUsers.length>0?"Online this moment:":"All users:"}),Object(b.jsx)(v,{handleBun:this.handleBun,handleMute:this.handleMute,onlineUsers:t,allUsers:n})]})]}),Object(b.jsx)("button",{className:"exitBtn",type:"button",onClick:this.handleExitBtn,children:"Exit"})]})}}]),n}(a.Component)),I=n(50),N=n.n(I),M={login:function(e){return N.a.post("https://chat-app-maybe.herokuapp.com/auth/login",e)}},w=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(o.a)(this,n);for(var s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];return(e=t.call.apply(t,[this].concat(a))).state={email:"",pwd:"",status:"default"},e.handleInputChange=function(t){e.setState(Object(l.a)({},t.target.name,t.target.value))},e.handleSubmit=function(t){t.preventDefault();var n=e.state,s={email:n.email,pwd:n.pwd};M.login(s).then((function(t){var n=t.data,s=n.answer,a=s.user,c=s.isAdmin,i=s.message;a&&e.setState({currentUser:a,isAdmin:c}),localStorage.setItem("token",n.token),e.setState({status:i,email:"",pwd:""})})).catch((function(t){var n;t.response.data.errors?n=t.response.data.errors.reduce((function(e,t){return e+" "+t.msg}),""):(n=t.response.data.error,console.log(n)),alert(n),e.setState({email:"",pwd:""})}))},e.handleChatExit=function(){e.setState({status:"default"}),localStorage.removeItem("token"),localStorage.removeItem("status")},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("status");this.setState({status:e||"default"})}},{key:"componentDidUpdate",value:function(e,t){t.status!==this.state.status&&localStorage.setItem("status",this.state.status)}},{key:"render",value:function(){var e=this.state,t=e.currentUser,n=e.isAdmin,s=e.status,a=e.email,c=e.pwd,i="authorized"===s;return Object(b.jsxs)(b.Fragment,{children:[i&&Object(b.jsx)(y,{handleChatExit:this.handleChatExit,isAdmin:n,currentUser:t}),"default"===s&&Object(b.jsx)(p,{handleSubmit:this.handleSubmit,handleInputChange:this.handleInputChange,pwd:c,email:a,userStatus:s})]})}}]),n}(a.Component);n(106);r.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(w,{})}),document.getElementById("root"))},13:function(e,t,n){e.exports={form:"Join_form__3X26n",title:"Join_title__1Sc_l",input:"Join_input__1Ma8e",label:"Join_label__34ufk",btn:"Join_btn__2XZ8s"}},56:function(e,t,n){},88:function(e,t,n){}},[[107,1,2]]]);
//# sourceMappingURL=main.b04d162e.chunk.js.map